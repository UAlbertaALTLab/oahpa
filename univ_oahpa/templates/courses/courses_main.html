{% extends 'univ_oahpa.html' %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}

{% comment %}
TODO: link in user interface

{% endcomment %}

{% block page_class %}fixed{% endblock %}
{% block imgprefix %}numra{% endblock %}

{% block content %}
	{# Add blocktrans and trans tags #}
	<div id="courses">
		<ul id="subnav">
			<li><a href="{% url univ_oahpa.courses.urls.logout %}">{% trans "Log out" %}</a></li>
			{% if profile.is_instructor %}
			<li><a href="/{{ URL_PREFIX }}/courses/">{% trans "Course overview" %}</a></li>
			{% endif %}
			{% if user.is_staff %}
			<li><a href="/{{ URL_PREFIX }}/admin/courses/">{% trans "Admin interface" %}</a></li>
			{% endif %}
		</ul>
		<h2>{% trans 'Welcome' %}, {{ user.username }}!</h2>
		{% if is_student %}
			<p>{% trans "Your courses" %} </p>
			<div class="courselist">
			{% for course in courses %}
				<h3>{{ course.identifier }} &ndash; {{ course.name }}</h3>
				{% if course.site_link %}
				    <a href="{{ course.site_link }}" target="BLANK">{% trans "View course lessons" %}</a></li>
				{% endif %}
				{% if course.goal_set.all|length > 0 %}
				    <p>Your instructor has defined the following
				        goals...</p>
				    <ul class="course_goal">
				    {% for goal in course.goal_set.all %}
        			    <li>
        			        <dl class="goal_definition">
        			            <dt>{{ goal.short_name }}</dt>
        			            <dd>{{ goal.description }}</dd>
        			            <dt></dt>
        			            <dd>Another field...</dd>
        			            <dt></dt>
        			            <dd><a href="{% url courses.views.begin_course_goal goal.id %}">Begin!</a></dd>
        			        </dl>
        			    </li>
				    {% endfor %}
			        </ul>
			    {% endif %}
			{% endfor %}
			</div>
			{% if new_profile %}
				<p>{% trans "You don't have any scores yet, go play some games!" %}</p>
			{% else %}
				<p>{% trans "The following scores represent your progress in the games available in Oahpa. Instructors will see your scores as shown below, but will also be able to see individual scores from every game. Good luck!" %}</p>

				{% load pretty_logs %}

				<h3>{% trans "Course progress" %}</h3>
				<dl class="course_progress">
					{% for summary in summaries %}
					<dt>{% for a in summary.game.name|filter_log %}{{ a }}{% if not forloop.last %} - {% endif %}{% endfor %}</dt>
						<dd>
							<ul>
								<li>{% trans "Average" %} &mdash; {{ summary.average }}</li>
								<li>{% trans "Highest score" %} &mdash; {{ summary.maximum }}</li>
								<li>{% trans "Lowest score" %} &mdash; {{ summary.minimum }}</li>
								<li>{% trans "Number of tries" %} &mdash; {{ summary.count }}</li>
							</ul>		
						</dd>
					{% endfor %}
				</dl>

			{% endif %}
		{% else %}
		<p>{% trans "You are a course instructor." %} {% trans "To view your own grade summary," %} <a href="/{{ URL_PREFIX }}/courses/?student_view=True">{% trans "click here" %}</a></p>
			<p><a href="/{{ URL_PREFIX }}/admin/courses/">{% trans "View students' grades" %}</a></p>
		{% endif %}
	</div>

{% endblock %}

